// home tab, which is the homepage allowing users to upload or select files to process
/*
This Component makes up the Home page of the React Web-page UI
Some important functions here are:
1. pollServer()
2. sendFileToServer()
3. onDrop() -> drop-zone for dropping PDFs
*/
import React, { Component } from 'react';
import Dropzone from 'react-dropzone'
import 'bootstrap/dist/css/bootstrap.min.css';
import Card from 'react-bootstrap/Card';
import Button from 'react-bootstrap/Button';
import CardGroup from 'react-bootstrap/CardGroup';
import Form from 'react-bootstrap/Form';
import Alert from 'react-bootstrap/Alert'
import Drawer from './subcomponents/Drawer';
import codeImg from './images/code.png';
import lightbulbImg from './images/lightbulb.png';
import userImg from './images/user.png';
import plusImg from './images/plus.png';
import axios from 'axios';
import 'axios-progress-bar/dist/nprogress.css'
import { loadProgressBar } from 'axios-progress-bar'
import 'react-pdf/dist/Page/AnnotationLayer.css';
import { withStyles } from "@material-ui/core/styles";
import ProgressBar from 'react-bootstrap/ProgressBar'
import ServerInfo from './subcomponents/ServerInfo.js'; // Relative path to your File
import MaterialTable, { MTableToolbar } from 'material-table';
import OpenInNewIcon from '@material-ui/icons/OpenInNew';
import IconButton from '@material-ui/core/IconButton';
import { blue } from '@material-ui/core/colors';
import GetAppIcon from '@material-ui/icons/GetApp';
import Slider from '@material-ui/core/Slider';
import Grid from '@material-ui/core/Grid';
import Typography from '@material-ui/core/Typography';
import Input from '@material-ui/core/Input';
import Modal from 'react-bootstrap/Modal'
//http://ycampus.southeastasia.cloudapp.azure.com
//http://localhost

const ip = ServerInfo.split(",")[0]
const port = ServerInfo.split(",")[1]
const defaultPDF = "data:application/pdf;base64,JVBERi0xLjcNCiW1tbW1DQoxIDAgb2JqDQo8PC9UeXBlL0NhdGFsb2cvUGFnZXMgMiAwIFIvTGFuZyhlbi1DQSkgL1N0cnVjdFRyZWVSb290IDEwIDAgUi9NYXJrSW5mbzw8L01hcmtlZCB0cnVlPj4vTWV0YWRhdGEgMjAgMCBSL1ZpZXdlclByZWZlcmVuY2VzIDIxIDAgUj4+DQplbmRvYmoNCjIgMCBvYmoNCjw8L1R5cGUvUGFnZXMvQ291bnQgMS9LaWRzWyAzIDAgUl0gPj4NCmVuZG9iag0KMyAwIG9iag0KPDwvVHlwZS9QYWdlL1BhcmVudCAyIDAgUi9SZXNvdXJjZXM8PC9Gb250PDwvRjEgNSAwIFI+Pi9FeHRHU3RhdGU8PC9HUzcgNyAwIFIvR1M4IDggMCBSPj4vUHJvY1NldFsvUERGL1RleHQvSW1hZ2VCL0ltYWdlQy9JbWFnZUldID4+L01lZGlhQm94WyAwIDAgNjEyIDc5Ml0gL0NvbnRlbnRzIDQgMCBSL0dyb3VwPDwvVHlwZS9Hcm91cC9TL1RyYW5zcGFyZW5jeS9DUy9EZXZpY2VSR0I+Pi9UYWJzL1MvU3RydWN0UGFyZW50cyAwPj4NCmVuZG9iag0KNCAwIG9iag0KPDwvRmlsdGVyL0ZsYXRlRGVjb2RlL0xlbmd0aCAxOTE+Pg0Kc3RyZWFtDQp4nKWOPQvCMBiE90D+w42J0Hy1NgZE0LaKYkGx4iAOHWoXDX4s/nxj6aCzN7xwvMfdA7m71R7jsSyzZQ4l17VvwRofTfd8MsEsz3CnRAn1kdMGCmm41hk8GkoOA3hKZhUlcq6htVAJqjMlOuQUNKwRyiSwyolh+FxDbrGzaJ+hE23nRr1bUHJkxau+8siyG4/ZheuYNeBRzDY8ZTmPEjbnJ1QrSoqwuKXkHzRtnHCjb7SOqAfB7xCKMsMbL608SQ0KZW5kc3RyZWFtDQplbmRvYmoNCjUgMCBvYmoNCjw8L1R5cGUvRm9udC9TdWJ0eXBlL1RydWVUeXBlL05hbWUvRjEvQmFzZUZvbnQvQkNERUVFK0NhbGlicmkvRW5jb2RpbmcvV2luQW5zaUVuY29kaW5nL0ZvbnREZXNjcmlwdG9yIDYgMCBSL0ZpcnN0Q2hhciAzMi9MYXN0Q2hhciAxMjAvV2lkdGhz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cmRmOmFib3V0PSIiICB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iPgo8ZGM6Y3JlYXRvcj48cmRmOlNlcT48cmRmOmxpPlNpbSBTaGVuZyBYdWU8L3JkZjpsaT48L3JkZjpTZXE+PC9kYzpjcmVhdG9yPjwvcmRmOkRlc2NyaXB0aW9uPgo8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiAgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIj4KPHhtcDpDcmVhdG9yVG9vbD5NaWNyb3NvZnTCriBXb3JkIGZvciBPZmZpY2UgMzY1PC94bXA6Q3JlYXRvclRvb2w+PHhtcDpDcmVhdGVEYXRlPjIwMjAtMDYtMjRUMTc6NTM6MDQrMDg6MDA8L3htcDpDcmVhdGVEYXRlPjx4bXA6TW9kaWZ5RGF0ZT4yMDIwLTA2LTI0VDE3OjUzOjA0KzA4OjAwPC94bXA6TW9kaWZ5RGF0ZT48L3JkZjpEZXNjcmlwdGlvbj4KPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIj4KPHhtcE1NOkRvY3VtZW50SUQ+dXVpZDo0RjdGRUUyRS1DMEVBLTRBRDQtODQxNi1DMkM2RUM0MkIyNTk8L3htcE1NOkRvY3VtZW50SUQ+PHhtcE1NOkluc3RhbmNlSUQ+dXVpZDo0RjdGRUUyRS1DMEVBLTRBRDQtODQxNi1DMkM2RUM0MkIyNTk8L3htcE1NOkluc3RhbmNlSUQ+PC9yZGY6RGVzY3JpcHRpb24+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAo8L3JkZjpSREY+PC94OnhtcG1ldGE+PD94cGFja2V0IGVuZD0idyI/Pg0KZW5kc3RyZWFtDQplbmRvYmoNCjIxIDAgb2JqDQo8PC9EaXNwbGF5RG9jVGl0bGUgdHJ1ZT4+DQplbmRvYmoNCjIyIDAgb2JqDQo8PC9UeXBlL1hSZWYvU2l6ZSAyMi9XWyAxIDQgMl0gL1Jvb3QgMSAwIFIvSW5mbyA5IDAgUi9JRFs8MkVFRTdGNEZFQUMwRDQ0QTg0MTZDMkM2RUM0MkIyNTk+PDJFRUU3RjRGRUFDMEQ0NEE4NDE2QzJDNkVDNDJCMjU5Pl0gL0ZpbHRlci9GbGF0ZURlY29kZS9MZW5ndGggODY+Pg0Kc3RyZWFtDQp4nGNgAIL//xmBpCADA4haBqHugSnGZ2CK6T2YYp4OpljaINRuCPUBKA/WzgShmCEUC4RihVCMEAqqkg2oj/UXWDs7xDCOVDCV/hhMlTgyMAAAUHQM4w0KZW5kc3RyZWFtDQplbmRvYmoNCnhyZWYNCjAgMjMNCjAwMDAwMDAwMTAgNjU1MzUgZg0KMDAwMDAwMDAxNyAwMDAwMCBuDQowMDAwMDAwMTY2IDAwMDAwIG4NCjAwMDAwMDAyMjIgMDAwMDAgbg0KMDAwMDAwMDQ4NiAwMDAwMCBuDQowMDAwMDAwNzUxIDAwMDAwIG4NCjAwMDAwMDA5MTkgMDAwMDAgbg0KMDAwMDAwMTE1OCAwMDAwMCBuDQowMDAwMDAxMjExIDAwMDAwIG4NCjAwMDAwMDEyNjQgMDAwMDAgbg0KMDAwMDAwMDAxMSA2NTUzNSBmDQowMDAwMDAwMDEyIDY1NTM1IGYNCjAwMDAwMDAwMTMgNjU1MzUgZg0KMDAwMDAwMDAxNCA2NTUzNSBmDQowMDAwMDAwMDE1IDY1NTM1IGYNCjAwMDAwMDAwMTYgNjU1MzUgZg0KMDAwMDAwMDAxNyA2NTUzNSBmDQowMDAwMDAwMDAwIDY1NTM1IGYNCjAwMDAwMDE5MjYgMDAwMDAgbg0KMDAwMDAwMjE0OSAwMDAwMCBuDQowMDAwMDI2NTk1IDAwMDAwIG4NCjAwMDAwMjk3NjEgMDAwMDAgbg0KMDAwMDAyOTgwNiAwMDAwMCBuDQp0cmFpbGVyDQo8PC9TaXplIDIzL1Jvb3QgMSAwIFIvSW5mbyA5IDAgUi9JRFs8MkVFRTdGNEZFQUMwRDQ0QTg0MTZDMkM2RUM0MkIyNTk+PDJFRUU3RjRGRUFDMEQ0NEE4NDE2QzJDNkVDNDJCMjU5Pl0gPj4NCnN0YXJ0eHJlZg0KMzAwOTENCiUlRU9GDQp4cmVmDQowIDANCnRyYWlsZXINCjw8L1NpemUgMjMvUm9vdCAxIDAgUi9JbmZvIDkgMCBSL0lEWzwyRUVFN0Y0RkVBQzBENDRBODQxNkMyQzZFQzQyQjI1OT48MkVFRTdGNEZFQUMwRDQ0QTg0MTZDMkM2RUM0MkIyNTk+XSAvUHJldiAzMDA5MS9YUmVmU3RtIDI5ODA2Pj4NCnN0YXJ0eHJlZg0KMzA3MDcNCiUlRU9G"
const options = {
  cMapUrl: 'cmaps/',
  cMapPacked: true,
};

const styles = theme => ({
  root: {
    '& > *': {
      marginTop: theme.spacing(2),
    },
  },
});

//Prevents multiple tabs from opening
var alreadyOpenedEditPage = false
var filename = ""
var curRequestNo = ""
var fileData = ""

function startStream(currentIP, currentTime, sessionID){
  console.log("hu")
  alreadyOpenedEditPage = false;
  if (!!window.EventSource) {
    var source = new EventSource(ip + ":" + port + '/stream?currentIP=' + currentIP
                                 + "&currentTime=" + currentTime + "&sessionID=" + sessionID
                                  + "&curRequestNo=" + curRequestNo);
    source.onmessage = function(e) {
      const dictStatus = JSON.parse(e.data)

      // const originalProgress = window.homeComponent.getCurrentProgress();
      // window.homeComponent.setCurrentProgress(originalProgress + 1);
      if (dictStatus === undefined){
        return;
      }
      console.log("a")
      if (dictStatus["curRequestNo"] !== curRequestNo){
        //IF this stream request belongs to an old request cancelled by the user
        source.close();
        return;
      }
      console.log("b")

      if (window.homeComponent !== undefined &&
          dictStatus["ipExists"] === "yes" && dictStatus["timeStampExists"] === "yes") {
        const filename = dictStatus["filename"]
        const level = dictStatus["level"]
        const subject = dictStatus["subject"]
        const year = dictStatus["year"]
        const school = dictStatus["school"]
        const exam = dictStatus["exam"]
        var statusString = ""
        if (dictStatus["stage"] === 4){
          statusString = "Done!"
        } else if (dictStatus["stage"] === 3) {
          statusString = "Stage:" + dictStatus["stage"] + "/3" + "(Output Generation)" + ", " +
              "Current Question:" + dictStatus["page"] + "/" + dictStatus["total"];
        } else if (dictStatus["stage"] === 2) {
          statusString = "Stage:" + dictStatus["stage"] + "/3" + "(Digitisation)" + ", " +
              "Current Page:" + dictStatus["page"] + "/" + dictStatus["total"];
        } else if (dictStatus["stage"] === 1) {
          statusString = "Stage:" + dictStatus["stage"] + "/3" + "(Image Conversion)" +
              ", Current Page:" + dictStatus["page"] + "/" + dictStatus["total"];
        }

        //$("#data").text(statusString);
        var progress = 0
        if (dictStatus["stage"] === 1){
          progress = (((dictStatus["page"] / dictStatus["total"])) * 100/3)
        } else if (dictStatus["stage"] === 2){
          progress = (((dictStatus["page"] / dictStatus["total"])) * 100/3) + 100/3
        } else if (dictStatus["stage"] === 3){
          progress = (((dictStatus["page"] / dictStatus["total"])) * 100/3) + 200/3
        } else if (dictStatus["stage"] === 4){
          progress = 100;
        }
        if (progress > window.homeComponent.getCurrentProgress()) {
          window.homeComponent.setCurrentProgress(progress);
        }

        window.homeComponent.setExtraMsg("Status: " + statusString);
    
        var isDone = dictStatus["stage"] === 4
        if (isDone === true && alreadyOpenedEditPage === false){
          alreadyOpenedEditPage = true;
          axios.post(ip + ":" + port + "/getresult?currentIP=" + currentIP + "&currentTime=" + currentTime
                    + "&sessionID=" + sessionID, {timeout : 1000 * 10})
            .then(function (response) {
              // handle success
              let newWindow = window.open('#/edit', '_self');
              newWindow.csvdata = response.data
              newWindow.fileData = fileData
              newWindow.myname = filename
              newWindow.level = level
              newWindow.subject = subject
              newWindow.year = year
              newWindow.school = school
              newWindow.exam = exam
              source.close();
            })
            .catch(function (error) {
              // handle error
              source.close();
            })
        }
      }
    }
  }
}


class home extends Component {

  constructor(props) {
     super(props);
     this.listPdfs()
     loadProgressBar()
     const columns = [
      { title: 'Name', field: 'name' },
      { title: 'Last Modified', field: 'lastModified', editable: 'never' },
      { title: 'Status', field: 'status', editable: 'never' }
    ]

    let useCustomPageRange = false;
    if (window.useCustomPageRange === true){
      useCustomPageRange = true;
    }
     this.state = {'columns' : columns,
                  'data' : [],
                  'msgVariant':'primary',
                  'msgText':'Upload a file to begin!',
                  'extraMsg': '',
                  'currentProgress': 0,
                  'filename' : '' ,
                  'numPages' : 0,
                  'file': defaultPDF,
                  'currentPageNumber': 1,
                  'sessionID' : "",
                  'requestNo' : 1,
                  'lastClick' : null,
                  'canSendRequest' : true,
                  'minPage' : 0,
                  'maxPage' : 100,
                  'currentStartPage' : 0,
                  'currentEndPage' : 0,
                  'useCustomPageRange' : useCustomPageRange,
                  'showPopup' : false,
                  'yourIP' : "",
                  'yourTime' : "",
                  'isOwnFile' : false,
                  'formData' : "",
    }
     //is this visible
     window.homeComponent = this;
     if(window.immediatelyProcessFile === "yes"){
      this.processFile(window.file);
    }

    if(window.immediatelyOpenSinglePdf === "yes"){
      this.openSinglePdf(window.file);
    }

  }

  pollServer = (formData, filename) => {
    filename = filename.replace(".pdf", "")
    if (this.state.useCustomPageRange){
      axios.post(ip + ":" + port + "/getpdfpages?name=" + filename + "&isExisting=no", formData, {timeout : 1000 * 100000000000000000000000000})
      .then(pageResponse => {
        this.setState({
            'msgVariant':'warning', 'msgText':"Selected file: '" + filename + ".pdf, processing...",
            'extraMsg':"Status: Server responded, processing...",
            'minPage' : 1,
            'maxPage' : pageResponse.data["noOfPages"],
            'currentStartPage' : 1,
            'currentEndPage' : pageResponse.data["noOfPages"],
            'showPopup' : true,
            'filename': filename,
            'isOwnFile': true,
            'formData' : formData,
          });
      })
    }
    else {
      console.log(filename)
      this.setState({
        'msgVariant':'warning', 'msgText':"Uploaded file: '" + filename + ".pdf, processing...",
        'extraMsg':"Status: Server responded, processing...",
        'isOwnFile': true,
        'formData' : formData,
        'filename': filename,
      })
      this.sendFileToServer(true);
    }
  }
  handlePaginationChange = (e, { activePage }) => {
    this.setState({
      'currentPageNumber': activePage,
    });
  }

  listPdfs = () => {
    axios.post(ip + ":" + port + "/listpdf?options=all", {timeout : 1000 * 100000000000000000000000000})
      .then(response => {
        // handle success
        const pdfsData = response.data['Pdfs'];
        this.setState({'data' : pdfsData});
        console.log(pdfsData)
      })  
  }

  openMultiplePdf = (names) => {
    const curTime = new Date()
    curRequestNo = curRequestNo + 1;
    if (this.state.lastClick != null){
      if (curTime.getTime() - this.state.lastClick.getTime() < 5000 || this.state.canSendRequest === false){
        alert("Too many requests made, please wait a while before trying again.")
        return;
      }
    }
    this.setState({'canSendRequest' : false, 'lastClick' : curTime})

    if (names.length >= 6){
      alert("Please do not process too many files at a time as it will overload our servers. Only the first 5 files that you selected will be processed")
    }

    if (names.length === 1){
      this.openSinglePdf(names[0])
    } else {
      names.map((name, index) =>
        {
          if (index <= 4){
            if (index === names.length - 1){
              this.openSinglePdf(name)
            } else {
              let newWindow = window.open('#/home');
              // Access it using its variable
              newWindow.immediatelyOpenSinglePdf = "yes";
              newWindow.file = name;
              newWindow.useCustomPageRange = this.state.useCustomPageRange;
            }
          }
        }
      );
    }
  };

  openSinglePdf = (name) => {
    curRequestNo = curRequestNo + 1;
    this.setState({'currentProgress': 0, 'msgVariant':'warning', 'msgText':"Selected file: '" + name + ".pdf', processing...", 'extraMsg':"Status: Waiting for server response..."});
    
    axios.post(ip + ":" + port + "/killsession?sessionID=" + this.state.sessionID, {timeout : 1000 * 100000000000000000000000000})
    .then(response => {
      this.setState({'canSendRequest' : true});
      if (this.state.useCustomPageRange){
        axios.post(ip + ":" + port + "/getpdfpages?name=" + name + "&isExisting=yes", {timeout : 1000 * 100000000000000000000000000})
        .then(pageResponse => {
          this.setState({
              'msgVariant':'warning',
              'msgText':"Selected file: '" + name + ".pdf', processing...",
              'extraMsg':"Status: Server responded, processing...",
              'minPage' : 1,
              'maxPage' : pageResponse.data["noOfPages"],
              'currentStartPage' : 1,
              'currentEndPage' : pageResponse.data["noOfPages"],
              'showPopup' : true,
              'filename': name,
              'isOwnFile': false,
            });
        })
      }
      else {
        this.setState({
          'msgVariant':'warning', 'msgText':"Selected file: '" + name + ".pdf', processing...",
          'extraMsg':"Status: Server responded, processing...",
          'isOwnFile': false,
          'filename': name,
        })
        this.sendFileToServer(true);
      }
    });
  }
  sendFileToServer(ignoreCustomPageRange){
    console.log(ignoreCustomPageRange)
    let currentStartPage = 0;
    let currentEndPage = this.state.maxPage;
    if (!ignoreCustomPageRange){
      currentEndPage = this.state.currentEndPage;
      currentStartPage = this.state.currentStartPage;
    }
    
    if(!this.state.isOwnFile){
      axios.post(ip + ":" + port + "/pushfile?name=" + this.state.filename + "&currentStartPage=" + currentStartPage
      + "&currentEndPage=" + currentEndPage + "&ignoreCustomPageRange=" + ignoreCustomPageRange
      , {timeout : 1000 * 100000000000000000000000000})
      .then(pushResponse => {
        // handle success
        fileData = pushResponse.data["pdf_base64"]
        this.setState({
          'yourIP' : pushResponse.data["YourIP"],
          'yourTime' : pushResponse.data["YourTime"],
          'sessionID': pushResponse.data['YourSessionID'],
          'showPopup' : false,
        });
        startStream(this.state.yourIP, this.state.yourTime, this.state.sessionID);
        
      })
    } else {
      console.log(this.state.filename)
      axios.post(ip + ":" + port + "/uploadfile?name=" + this.state.filename + "&currentStartPage="
          + currentStartPage + "&currentEndPage=" + currentEndPage + "&ignoreCustomPageRange=" + ignoreCustomPageRange
          , this.state.formData, {timeout : 1000 * 100000000000000000000000000})
      .then(uploadResponse => {
        // handle success
        console.log(uploadResponse)
        fileData = uploadResponse.data["pdf_base64"]
        this.setState({
          'yourIP' : uploadResponse.data["YourIP"],
          'yourTime' : uploadResponse.data["YourTime"],
          'sessionID': uploadResponse.data['YourSessionID'],
          'showPopup' : false,
        });
        startStream(this.state.yourIP, this.state.yourTime, this.state.sessionID);
        
      })
    }
  }

  downloadPDFs(files) {
    files.map((file, index) =>
      {
        const name = file.name
        axios.post(ip + ":" + port + "/openpdf?name=" + name, {timeout : 1000 * 100000000000000000000000000})
        .then(response => {
          // handle success
          const linkSource = response.data['fileData'];  //localFileData
          const downloadLink = document.createElement("a");
          const fileName = name + ".pdf";
          downloadLink.href = linkSource;
          downloadLink.download = fileName;
          downloadLink.click();
        }) 
      }
    );
  }

  getIp = () => {
    return ip;  
  }

  getPort = () => {
    return port;  
  }
  
  setMsg = () => {
    //this.setState({'msgVariant':'primary', 'msgText':'Upload a file to begin!', 'extraMsg': ''});
  }

  getCurrentProgress = () => {
    return this.state.currentProgress;
  }

  setCurrentProgress = (currentProgress) => {
    this.setState({'currentProgress': currentProgress});
  }

  setExtraMsg = (extraMsg) => {
    this.setState({'extraMsg': extraMsg});
  }

  onDrop = (files) => {
    const curTime = new Date()
    if (this.state.lastClick != null){
      if (curTime.getTime() - this.state.lastClick.getTime() < 5000 || this.state.canSendRequest === false){
        alert("Too many requests made, please wait a while before trying again.")
        return;
      }
    }
    this.setState({'lastClick' : curTime})
    if (files.length >= 6){
      alert("Please do not process too many files at a time as it will overload our servers. Only the first 5 files that you selected will be processed")
    }

    if (files.length === 1){
      this.processFile(files[0])
    } else {
      files.map((file, index) =>
        {
          if (index <= 4){
            if (index === files.length - 1){
              this.processFile(file)
            } else {
              let newWindow = window.open('#/home');
              // Access it using its variable
              newWindow.immediatelyProcessFile = "yes";
              newWindow.file = file;
              newWindow.useCustomPageRange = this.state.useCustomPageRange;
            }
          }
        }
      );
    }
  };

  processFile = (file) => {
    const reader = new FileReader();
    this.setState({'currentProgress': 0});
    reader.onload = (event) => {
      //fileData = event.target.result;
    };

    reader.readAsDataURL(file);
    const filename = file.name;
    curRequestNo = curRequestNo + 1;
    this.setState({
      'canSendRequest' : false,
      'currentProgress': 0,
      'msgVariant':'warning', 'msgText':"Received file: '" + filename + "', processing...",
      'extraMsg':"Status: Waiting for server response...",
    });

    // Create an object of formData 
      const formData = new FormData();
      // Update the formData object 
      formData.append("myFile", file);
      // Request made to the backend api 
      // Send formData object 
      axios.post(ip + ":" + port + "/killsession?sessionID=" + this.state.sessionID,
          {timeout : 1000 * 100000000000000000000000000})
        .then(response => {
          this.setState({'canSendRequest' : true});
          this.pollServer(formData, filename);
      });
    }
  
  handleClosePopup = (event, newValue) => {};

  handleChangeSlider = (event, newValue) => {
    this.setState({
      'currentStartPage' : newValue[0],
      'currentEndPage' : newValue[1]
    })
  };

  handleSliderStartInputChange = (event) => {
    this.setState({
      'currentStartPage': (event.target.value === '' ? '' : Number(event.target.value))
    })
  };

  handleSliderEndInputChange = (event) => {
    this.setState({
      'currentEndPage': (event.target.value === '' ? '' : Number(event.target.value))
    })
  };

  handleSliderStartBlur = () => {
    if (this.state.currentStartPage < 0) {
      this.setState({
        'currentStartPage': 0
      })
    } else if (this.state.currentStartPage > 100) {
      this.setState({
        'currentStartPage': 100
      })
    }
  };

  handleSliderEndBlur = () => {
    if (this.state.currentEndPage < 0) {
      this.setState({
        'currentEndPage': 0
      })
    } else if (this.state.currentEndPage > 100) {
      this.setState({
        'currentEndPage': 100
      })
    }
  };

  handleChangeCheckbox = (e) => {
    this.setState({
      'useCustomPageRange' : e.target.checked})
  };

  render() {
    let list = [];
    let smallest = 149;
    let displayLength = false;
    if (this.state.data.length < smallest){
      smallest = this.state.data.length
    } else {
      displayLength = true;
    }
    
    for (var i = 10; i <= smallest + 10; i = i + 10) {
        list.push(i);
    }
    if (displayLength){
      list.push(this.state.data.length)
    }
    list = Array.from(new Set(list));

    const body = 
    <div>
      <Modal
        show={this.state.showPopup}
        backdrop="static"
        keyboard={false}
        aria-labelledby="contained-modal-title-vcenter"
        centered
        onHide={this.handleClosePopup}
      >
        <Modal.Header>
          <Modal.Title>Custom Page Range</Modal.Title>
        </Modal.Header>
        <Modal.Body>
          <Grid style = {{"paddingBottom" : "15px"}} container spacing={2} alignItems="center">
        
            <Grid item>
              <Typography id="input-slider" gutterBottom>
                Page Range
              </Typography>
            </Grid>

            <Grid item>
              <Input
                value={this.state.currentStartPage}
                onChange={this.handleSliderStartInputChange}
                onBlur={this.handleSliderStartBlur}
                margin="dense"
                inputProps={{
                  step: 1,
                  min: this.state.minPage,
                  max: this.state.maxPage,
                  defaultValue: 1,
                  type: 'number',
                  'aria-labelledby': 'input-slider',
                }}
              />
            </Grid>
            
            <Grid item xs>
              <Slider
              value={[this.state.currentStartPage, this.state.currentEndPage]}
              valueLabelDisplay="auto"
              step={1}
              marks
              onChange={this.handleChangeSlider}
              min={this.state.minPage}
              max={this.state.maxPage}
              aria-labelledby="range-slider"
              />
            </Grid>

            <Grid item>
              <Input
                margin="dense"
                value={this.state.currentEndPage}
                onChange={this.handleSliderEndInputChange}
                onBlur={this.handleSliderEndBlur}
                inputProps={{
                  step: 1,
                  min: this.state.minPage,
                  max: this.state.maxPage,
                  defaultValue: this.state.maxPage,
                  type: 'number',
                  'aria-labelledby': 'input-slider',
                }}
              />
            </Grid>

          </Grid>
        </Modal.Body>
        <Modal.Footer>
          <Button onClick={() => this.sendFileToServer(false)} variant="primary">Confirm</Button>
        </Modal.Footer>
      </Modal>

      <Alert style={{"width" : "100%", "height" : "90%"}} variant={"success"}>
        <p>
          A simple React website which allows you to Digitise Singapore Primary/Secondary school exam papers from PDF, and receive the output as a CSV file containing the text of the questions.
        </p>
      </Alert>
      <Alert style={{"width" : "100%", "height" : "90%"}} variant={this.state.msgVariant}>
        <p>
          {this.state.msgText}
        </p>
        <hr/>
        <p>
          {this.state.extraMsg}
        </p>
      </Alert>
      <ProgressBar style={{"marginTop" :"10px", "marginBottom" :"10px"}} animated now={this.state.currentProgress} />

      <Form.Group style = {{"paddingTop" : "10px"}} controlId="formBasicCheckbox">
        <div style = {{flexGrow : "10", display: 'flex', flexDirection: 'row', alignItems:'left'}}>
          <Form.Check defaultChecked = {this.state.useCustomPageRange} onChange = {this.handleChangeCheckbox} type="checkbox"/>
          <div style = {{"paddingTop" : "3px"}}>
            <h6>
              Choose custom PDF page range
            </h6>
          </div>
        </div>
      </Form.Group>

      <Dropzone style={{"width" : "100%", "height" : "50%", "paddingBottom" : "10px"}} name={"hey"} onClick={this.setMsg} onDrop={this.onDrop}>
        <div style = {{flexGrow : "10", display: 'flex', flexDirection: 'column', alignItems:'center', outline: "5px dotted black"}}>
          <div style = {{height : "30px"}}>

          </div>
              <Button onClick={this.setMsg} style = {{height : "90%", width : "50%"}} variant="success">
              <Card.Img style = {{height : "50px", width : "50px"}} variant="left" src={plusImg} />
              Choose PDF File (from local drive)
              </Button>{' '}
          <div style = {{height : "20px"}}/>
          <h4>
            ... Or Drag and Drop that Document.(Multiple files supported, maximum 5)
          </h4>
          <p>
            We'll do the rest for you
          </p>
        </div>
      </Dropzone>    

      <Alert style={{"width" : "100%", "height" : "90%"}} variant={"info"}>
        <p>
          Upload your own PDF file above, or select any PDF file below from our database!  
        </p>
      </Alert>

      <MaterialTable
          title="Available PDFs"
          columns={this.state.columns}
          data={Array.from(this.state.data)}
          key={ Array.from(this.state.data).length }
          options={{
            search: true,
            exportButton: true,
            pageSize:10,
            exportAllData: true,
            pageSizeOptions: list,
            selection: true
          }}
          actions={[
            {
              icon: 'process',
              onClick: (event, data) => {
                var names = []
                data.map((rowData) =>
                {
                  names.push(rowData.name);
                }
                );
                this.openMultiplePdf(names);
              }
            },
            
          ]}
          components={{
            Action: props => (
              <div style = {{flexGrow : "10", display: 'flex', flexDirection: 'row', alignItems:'center'}} >
                <IconButton
                onClick={(event) => props.action.onClick(event, props.data)}
                  style={{ color: blue[500], textTransform: 'none' }}
                  aria-label="process"
                  title={"Process PDF"}
                >  
                  <OpenInNewIcon />
                </IconButton>
                <IconButton
                onClick={(event) => this.downloadPDFs(props.data)}
                  style={{ color: blue[500], textTransform: 'none' }}
                  aria-label="download"
                  title={"Download PDF"}
                >  
                  <GetAppIcon />
                </IconButton>
              </div>
            ),
            Toolbar: props => (
              <div>
                <MTableToolbar {...props } />
              </div>
            ),
          }}
        />

      <div style = {{"height" : "20px"}}/>
      <CardGroup>
        <Card>
          <Card.Img variant="top" src={lightbulbImg} />
          <Card.Body>
            <Card.Title>Simple to use</Card.Title>
            <Card.Text>
              Just drag-and-drop your PDF file in the box above, wait for the compression to complete and download your file. It's that simple..
            </Card.Text>
          </Card.Body>
          <Card.Footer>
            <small className="text-muted">Last updated 3 mins ago</small>
          </Card.Footer>
        </Card>
        <Card>
          <Card.Img variant="top" src={userImg} />
          <Card.Body>
            <Card.Title>User friendly</Card.Title>
            <Card.Text>
              Easy-to-use user interface that segments the exam paper PDF you upload into pages and questions. Simply edit the text within the question text boxes.
            </Card.Text>
          </Card.Body>
          <Card.Footer>
            <small className="text-muted">Last updated 3 mins ago</small>
          </Card.Footer>
        </Card>
        <Card>
          <Card.Img variant="top" src={codeImg} />
          <Card.Body>
            <Card.Title>No coding required</Card.Title>
            <Card.Text>
              Everything is done for you, just for you. The extra processing is done in the background and you will not have to worry about it.
            </Card.Text>
          </Card.Body>
          <Card.Footer>
            <small className="text-muted">Last updated 3 mins ago</small>
          </Card.Footer>
        </Card>
      </CardGroup>
    </div>
    return (
      <div>
        <Drawer content = {body} name = "Home"/>
      </div>
    );
    }
}

export default withStyles(styles, { withTheme: true })(home);